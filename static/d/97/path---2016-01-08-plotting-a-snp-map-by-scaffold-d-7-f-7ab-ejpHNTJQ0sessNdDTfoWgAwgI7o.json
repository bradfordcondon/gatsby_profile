{"data":{"markdownRemark":{"html":"<p> </p>\n<p>I wanted to plot out SNPs along a chromosome. I was starting with SNP tables that were roughly equivalent to a .bed file:</p>\n<pre><code>scaffold00001   97859   97859\nscaffold00001   176752  176752\n</code></pre>\n<p>Where the first column is the scaffold # in the reference, and the second and third columns are SNP locations. I adapted the R code below to print out SNP densities for select scaffolds. Because we’re working with hundreds, if not thousands, of scaffolds, it’s necessary to filter out the scaffolds of interest in some way, either by number of SNPs or the specific scaffolds of interest.</p>\n<p> </p>\n<p>We do two quick things to help us out.  The first is use count() and match() to generate a column which essentially counts the number of SNPs for each scaffold.  Then we use order() to sort by this new SNP count column.</p>\n<pre><code>    library(plyr)\n    library(ggplot2)\n    \n    setwd(\"/your path\")\n    snps&#x3C;-read.table(\"out.txt\",sep=\"\\t\",header=F)\n    \n    colnames(snps)&#x3C;-c(\"chr\",\"start\",\"end\")\n    \n    #Column of # SNPs\n    counts= count(snps[1])\n    snps$Count &#x3C;- counts[[2]][ match( snps$chr, counts[[1]] ) ]\n    \n    snpsorder= snps[order(-snps[,4]),] \n    \n    subset= subset(snpsorder, Count > 40000)\n    \n    # Plot SNP density\n    toprint&#x3C;-ggplot(subset) + \n      geom_histogram(aes(x=start), binwidth=1000) + # binwidth will effectively set the printing window size.\n      facet_wrap(~ chr,ncol=2) + # fiddle with number of columns depending on how many scaffolds you print\n      ggtitle(\"SNPs\") +\n        xlab(\"nucleotide number\") +   ylab(\"SNP density\") +   theme_bw() \n    \n    \n    # save to .png\n    png(\"snps.png\",750,750)\n    print(toprint)\n    dev.off()\n</code></pre>\n<p>The above R code will plot the only scaffold with over 40k SNP counts. I chose this number because it prints the below plot.</p>\n<img class=\"alignnone\" src=\"https://i1.wp.com/i.imgur.com/x6qbUuU.png?resize=500%2C750\" alt=\"\" data-recalc-dims=\"1\" />\n<p>If I reduce the minimum to 20,000, I print a few more scaffolds</p>\n<p><a href=\"https://i1.wp.com/www.bradfordcondon.com/wp-content/uploads/2016/01/snpsall.png\" rel=\"attachment wp-att-542\"><img class=\"alignnone size-full wp-image-542\" src=\"https://i1.wp.com/www.bradfordcondon.com/wp-content/uploads/2016/01/snpsall.png?fit=500%2C750\" alt=\"multiple SNP plots\" srcset=\"https://i1.wp.com/www.bradfordcondon.com/wp-content/uploads/2016/01/snpsall.png?w=500 500w, https://i1.wp.com/www.bradfordcondon.com/wp-content/uploads/2016/01/snpsall.png?resize=200%2C300 200w\" sizes=\"(max-width: 500px) 100vw, 500px\" data-recalc-dims=\"1\" /></a></p>\n<p>Hope this code is helpful to you!</p>\n<p> </p>","frontmatter":{"title":"Plotting a SNP map by scaffold"}}},"pageContext":{"slug":"/2016-01-08-plotting-a-snp-map-by-scaffold/"}}
{"data":{"markdownRemark":{"html":"<p>Every programming language and subcommunity has rules regarding <a href=\"https://en.wikipedia.org/wiki/Programming_style\">code styling</a>. Drupal <a href=\"https://www.drupal.org/docs/develop/standards\">provides a set of style standards</a>, but how do you know that your code is meeting them?  If a collaborator contributes to your project, how do you know that they followed the guidelines?</p>\n<p>This miniature guide will walk us through installing a Drupal style sniffer, automatic beautifier, and a continuous integration check for our code styling.  The guide is specific for PHPStorm.</p>\n<h3>Adding the code sniffer</h3>\n<p>The official <a href=\"https://www.drupal.org/node/1419988\">Drupal Code Sniffer guide</a> should be sufficient for adding and configuring the code sniffer via composer.  This guide will walk you through</p>\n<ul>\n<li>installing Composer</li>\n<li>installing the PHP Code Sniffer (PHPCS)</li>\n<li>installing the coder module</li>\n<li>registering the Drupal code standard with PHPCS</li>\n<li>Adding the Drupal standard to PhpStorm.</li>\n</ul>\n<h3>Adding the code formatter</h3>\n<p>Unfortunately, the sniffer won't automatically fix the styling for you, it will only alert you to the problem.  To automate fixing simple code \"smells\", we can configure PHPCBF (PHP code beautifier) to run as an external tool in PHPStorm.</p>\n<p>I <a href=\"https://hamrant.com/post/code-beautifier-and-fixer\">followed this guide by @hamrant</a> to add the tool.</p>\n<p>for the program path, use the output of <code class=\"language-text\">which phpcbf</code>.</p>\n<p>Argument would be set to: <code class=\"language-text\">--standard=Drupal $fileDir$/$FileName$</code>\nworking directory: <code class=\"language-text\">$ProjectFileDir$</code></p>\n<p><img src=\"/img/phpcbf_script_config.png\" alt=\"phpcbf script configuration\"></p>\n<p>(Note:  If you get a weird error about your working directory, double check your working directory argument!  I had whitespace in mine).</p>\n<p>Once the tool is configured, you can map it to a shortcut to make it easier to use.  I mapped my tool to run on apple -alt - ; , which is right next to my general beautifier (apple - alt - l).</p>\n<h3>setting up CI</h3>\n<p>Finally we want a continuous integration check so that when PRs are made, it runs the code sniffer and gives us feedback on style. I used Code Climate because its free for open source projects, but any service that lets you specify what files to check and what standards to use will work.  <a href=\"https://docs.codeclimate.com/docs/configuring-your-analysis\">https://docs.codeclimate.com/docs/configuring-your-analysis</a></p>\n<p>The configuration file to ensure that our Drupal codes are read against Drupal standards is simple: place this <code class=\"language-text\">.code_coverage.yml</code> file in your project root.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2\"</span>\n<span class=\"token key atrule\">plugins</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">phpcodesniffer</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">enabled</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">config</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">file_extensions</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"php,inc,module\"</span>\n      <span class=\"token key atrule\">standard</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Drupal\"</span></code></pre></div>","frontmatter":{"title":"PHPstorm and Drupal styling"}}},"pageContext":{"slug":"/2018-12-10-drupal_sniffing/"}}